<!-- 
    EMPLOYEE DROPDOWN COMPONENT - ƒê√É S·ª¨A XUNG ƒê·ªòT
    - Th√™m prefix "main-" cho t·∫•t c·∫£ classes v√† IDs
    - Tr√°nh xung ƒë·ªôt v·ªõi form template
-->
<div class="main-employee-dropdown-component">
    <div class="form-group">
        <label class="form-label">{{ label_text or "Ch·ªçn nh√¢n vi√™n" }}</label>
        <div style="display: flex; gap: 8px; align-items: flex-end;">
            <div class="main-employee-search" style="flex: 1;">
                <input type="text" 
                       class="form-control main-employee-search-input" 
                       placeholder="G√µ t√™n, m√£ NV ho·∫∑c ph√≤ng ban..."
                       autocomplete="off">
                <input type="hidden" 
                       class="main-employee-hidden-input" 
                       name="{{ field_name }}" 
                       value="{{ current_value or '' }}">
                
                <div class="main-employee-dropdown">
                    <div class="employee-dropdown-info">
                        <small>G√µ √≠t nh·∫•t 2 k√Ω t·ª± ƒë·ªÉ t√¨m ki·∫øm</small>
                    </div>
                    {% for emp in employees %}
                    <div class="main-employee-option" 
                         data-value="{{ emp.id }}" 
                         data-name="{{ emp.name }}"
                         data-department="{{ emp.department or '' }}">
                        <strong>{{ emp.name }}</strong> ({{ emp.id }})
                        {% if emp.department %}
                        <br><small>{{ emp.department }}</small>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
            </div>
            
            <!-- N√∫t refresh v·ªõi target ƒë√£ ƒë∆∞·ª£c s·ª≠a ƒë·ªÉ tr√°nh xung ƒë·ªôt -->
            <button type="button" 
                    class="btn-refresh main-btn-refresh"
                    hx-post="/refresh-employees"
                    hx-trigger="click"
                    hx-target="#main-refresh-status-{{ field_name }}"
                    hx-indicator=".spinner"
                    title="L√†m m·ªõi danh s√°ch nh√¢n vi√™n">
                <span class="btn-text">üîÑ</span>
                <span class="htmx-indicator spinner"></span>
            </button>
        </div>
        
        <!-- Khu v·ª±c hi·ªÉn th·ªã tr·∫°ng th√°i refresh v·ªõi ID duy nh·∫•t -->
        <div id="main-refresh-status-{{ field_name }}" class="refresh-status-container"></div>
    </div>
</div>
